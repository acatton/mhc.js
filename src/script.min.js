(function(){var n,t,r,e,u,i,o,f,c,s,a,h,l,p,d,v,w,m,g,b,y,P,j,A,M,S={}.hasOwnProperty;e=8,n=7,t=(1<<n)-1,r=64,a=31,f=6,c=(1<<f)-1,s=128,j=function(n){var t;return t=new Uint8Array(n.length),t.set(n),t},l=function(n,t){return Math.log(n)/Math.log(t)},M=function(t){var r,u,i,o,h,p;if(o=function(n){return 1+Math.floor(l(n,2))},r=o(t),n>=r)return[t];if(r>a)throw new Error("UTF-8 doesn't support characters encoded on more than "+a+"bits");for(u=0,i=[],h=function(){return e-2-u},p=function(){var n;return n=(1<<u)-1,n<<=2,n|=2,n<<=h()};o(t)>h();)i.unshift(t&c|s),t>>=f,u++;return i.unshift(t|p()),i},y=function(n){return j(n.split("").reduce(function(n,t){return n.concat(M(t.charCodeAt(0)))},[]))},g=function(n){return window.crypto.subtle.digest("SHA-1",n.buffer).then(function(n){return new Uint8Array(n)})},h=function(n){var t,r;return r=function(n){return n.toString(16)},(t=function(n,t,r){var e,u,i,o;for(e=r,u=i=0,o=n.length-1;o>=0?o>=i:i>=o;u=o>=0?++i:--i)e=t(e,n[u]);return e})(n,function(n,t){return n+(t>16?r(t):"0"+r(t))},"")},o=1,u=20,i=16,p=function(n){var t;return t=function(n){return n%=100,10>n?"0"+n:""+n},[n.getFullYear(),n.getMonth(),n.getHours(),n.getMinutes(),n.getSeconds()].reduce(function(n,r){return n+t(r)},"")},d=function(n,t,r,e,i,f,c){return null==n&&(n=o),null==t&&(t=u),null==r&&(r=new Date),r="string"==typeof r?r:p(r),null==e&&(e=""),null==i&&(i=""),null==c&&(c=""),[n,t,r,e,i,f,c].join(":")},w=function(n){var t;if(t=function(n,t){return String.fromCharCode(n.charCodeAt(0)+t)},n>=0&&25>=n)return t("A",n);if(n>=26&&51>=n)return t("a",n-26);if(n>=52&&61>=n)return t("0",n-52);if(62===n)return"+";if(63===n)return"/";throw new Error("intToBase64Char is supposed to get an ingeter between 0 and 63")},m=function(n){var t;return function(){var r,e;for(e=[],t=r=1;n>=1?n>=r:r>=n;t=n>=1?++r:--r)e.push(w(0|63*Math.random()));return e}().join("")},b=function(n){return g(y(n)).then(function(n){return h(n)})},P=function(n){var t,r,e,u,i,o,f;if(e=function(n,t){return Promise.all([n,t].map(P)).then(function(n){return Promise.all(n.map(b))}).then(function(n){return b(n.join(""))})},r=function(n){return Promise.all(n.map(P)).then(function(n){return Promise.all(n.map(b))}).then(function(n){return n.sort(),b(n.join(""))})},u=function(n){var t,u;return Promise.all(function(){var r;r=[];for(t in n)S.call(n,t)&&(u=n[t],"function"!=typeof u&&r.push(e(t,u)));return r}()).then(function(n){return r(n)})},f=function(n){return n.match(/:/)?b(n):new Promise(function(t){return t(n)})},i=function(n){return new Promise(function(t){return t(""+n)})},t=function(n){return r(n)},o=function(n){return u(n)},"string"==typeof n)return f(n);if("number"==typeof n)return i(n);if(n.isArray)return t(n);if("object"==typeof n)return o(n);throw new Error("toResource only supports strings, numbers and objects")},window.Hashcash=function(){function n(n){var t;t=n.split(":"),this.version=t[0],this.bits=t[1],this.date=t[2],this.resource=t[3],this.extension=t[4],this.rand=t[5],this.counter=t[6],null==this.bits&&(this.bits=u),this.bits=0|this.bits}return n.prototype.toString=function(){return d(this.version,this.bits,this.date,this.resource,this.extension,this.rand,this.counter)},n.prototype.findSolution=function(){var t,e,u,i,o;return o=function(n){return n.map(w).join("")},e=function(n){return function(t){return d(n.version,n.bits,n.date,n.resource,n.extension,n.rand,o(t))}}(this),i=function(n){return function(t){var r;return r=e(t),g(y(r)).then(function(t){return A(t)>=n.bits})}}(this),u=function(n){var t,e;for(t in n)if(e=n[t],n[t]=(e+1)%r,n[t]>0)return n;return n.push(0),n},t=function(t){return new n(e(t))},new Promise(function(n){var r,e;return e=[0],(r=function(e){return i(e).then(function(i){return i?n(t(e)):r(u(e))})})(e)})},n}(),window.Hashcash.fromResource=function(n){var t;return t=m(i),new Hashcash(d(null,null,null,n,null,t,null))},v=function(n,t){return 0===n?t:t-(1+Math.floor(l(n,2)))},A=function(n){var t,r,u,i,o;for(t=0,r=i=0,o=n.length-1;(o>=0?o>=i:i>=o)&&(u=n[r],t+=v(u,e),!(u>0));r=o>=0?++i:--i);return t}}).call(this);